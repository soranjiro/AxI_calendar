# オールインワンカレンダーアプリ 要件定義書

## 1. 概要

### 1.1. プロジェクト名

オールインワンカレンダーアプリ（仮称）

### 1.2. 目的

本アプリは、ユーザーが「予定管理」「ToDo 管理」「家計簿」など、複数の異なる目的のカレンダー情報を一つのインターフェース上で統合的に管理・可視化することを目的とする。さらに、ユーザーが独自の管理テーマ（例：習慣トラッカー、学習記録など）を自由に追加できる拡張性を提供し、個々のニーズに合わせたパーソナルな管理ツールとなることを目指す。

### 1.3. ターゲットユーザー

- 複数のツールやアプリでスケジュール、タスク、支出などを管理しているユーザー
- 自分に必要な管理項目をカスタマイズしたいユーザー
- 情報を一元管理し、俯瞰的に把握したいユーザー

## 2. 機能要件

### 2.1. コア機能

- **カレンダー表示:**
  - 月表示、週表示、日表示の切り替え機能を提供する。
  - 各日付には、登録されているすべてのテーマのイベント/データが識別可能な形で表示される（例：色分け、アイコン表示）。
- **統合表示:**
  - 選択した期間（日/週/月）に含まれる、すべての有効なテーマのイベント/データをカレンダー上に表示する。
- **テーマ別フィルター:**
  - 表示するテーマを選択し、特定のテーマの情報のみをカレンダー上に表示するフィルター機能を提供する。複数のテーマを選択することも可能とする。

### 2.2. テーマ管理機能

- **デフォルトテーマ:**
  - 初期状態で以下のテーマを提供する。
    - **予定管理:** イベント名、開始日時、終了日時、場所、メモなどの項目を持つ。
    - **ToDo 管理:** タスク名、期限日時、完了ステータス、優先度、メモなどの項目を持つ。
- **カスタムテーマ作成:**
  - ユーザーが新しいテーマを定義できる機能を提供する。
  - 例：
    - **家計簿:** 日付、費目、金額（収入/支出）、メモなどの項目を持つ。
  - テーマ作成時には、以下の情報をユーザーが指定する。
    - `theme_name`: テーマの名称 (例: "読書記録", "筋トレログ")
    - `fields`: テーマで管理したいデータ項目とその属性。各項目は以下の情報を持つ。
      - `name`: 項目名 (例: "書籍名", "読了日", "評価")
      - `type`: データ型 (例: "テキスト", "日付", "日時", "数値", "真偽値", "選択肢")
      - `required`: 必須項目か否か (Boolean)
      - (その他、選択肢リスト、デフォルト値などの属性も検討)
- **テーマ編集:**
  - ユーザーが作成したカスタムテーマの名称や項目 (`fields`) を編集できる機能を提供する。
  - (デフォルトテーマの編集可否は検討事項とする)
- **テーマ削除:**
  - ユーザーが作成したカスタムテーマを削除できる機能を提供する。
  - テーマ削除時には、関連するイベント/データも削除されるか、あるいは保持するかを選択可能とする（要検討）。
- **テーマ一覧表示:**
  - 現在利用可能なテーマ（デフォルトおよびカスタム）を一覧で表示・管理する画面を提供する。

### 2.3. イベント/データ管理機能

- **イベント/データ登録:**
  - カレンダー上の日付を選択、または専用の追加ボタンから、任意のテーマに属する新しいイベント/データを登録できる機能を提供する。
  - 登録インターフェースは、選択されたテーマの `fields` 定義に基づいて動的に生成され、必要な入力項目を表示する。
  - 各項目のデータ型に応じた入力 UI（テキストフィールド, DatePicker, TimePicker, Checkbox, SelectBox など）を提供する。
- **イベント/データ編集:**
  - 登録済みのイベント/データを編集できる機能を提供する。
- **イベント/データ削除:**
  - 登録済みのイベント/データを削除できる機能を提供する。
- **検索機能:**
  - 登録されたイベント/データをキーワードや期間、テーマなどで検索できる機能を提供する。

### 2.4. ユーザー認証機能

- **アカウント作成:**
  - ユーザーがメールアドレスとパスワードを用いて新規アカウントを作成できる機能を提供する。
- **ログイン:**
  - 登録済みのメールアドレスとパスワードでログインできる機能を提供する。
  - ログイン状態はセッションまたはトークンで管理し、アプリ再起動後も維持される（オプション）。
- **ログアウト:**
  - ユーザーが明示的にログアウトできる機能を提供する。
- **（オプション）パスワードリセット:**
  - ユーザーがパスワードを忘れた場合に、メールアドレス経由でリセットできる機能を提供する。

### 2.5. データ構造（提案）

- **テーマ定義テーブル (`themes`)**

  - `theme_id`: UUID (Primary Key) - テーマの一意な識別子
  - `theme_name`: String - テーマ名
  - `fields`: JSON - テーマ固有の項目定義リスト
    ```json
    [
      {
        "name": "title",
        "label": "タイトル",
        "type": "text",
        "required": true
      },
      {
        "name": "start_datetime",
        "label": "開始日時",
        "type": "datetime",
        "required": true
      },
      {
        "name": "end_datetime",
        "label": "終了日時",
        "type": "datetime",
        "required": false
      },
      {
        "name": "location",
        "label": "場所",
        "type": "text",
        "required": false
      },
      { "name": "memo", "label": "メモ", "type": "textarea", "required": false }
    ]
    ```
  - `is_default`: Boolean - デフォルトテーマか否か
  - `user_id`: UUID (Foreign Key to `users.user_id`, Nullable for default themes) - テーマを作成したユーザーの ID（カスタムテーマの場合）
  - `created_at`: Timestamp
  - `updated_at`: Timestamp

- **イベント/データテーブル (`entries`)**

  - `entry_id`: UUID (Primary Key) - 各エントリの一意な識別子
  - `theme_id`: UUID (Foreign Key to `themes.theme_id`) - 関連するテーマの ID
  - `user_id`: UUID (Foreign Key to `users.user_id`) - エントリを作成したユーザーの ID
  - `data`: JSON - テーマの `fields` に基づいて入力された実際のデータ

    ```json
    // 例: 予定テーマのエントリ
    {
      "title": "チームミーティング",
      "start_datetime": "2025-05-10T14:00:00Z",
      "end_datetime": "2025-05-10T15:00:00Z",
      "location": "会議室A",
      "memo": "プロジェクト進捗確認"
    }

    // 例: 家計簿テーマのエントリ
    {
       "date": "2025-05-02",
       "category": "食費",
       "amount": -1500, // 支出は負数、収入は正数などルールを定める
       "memo": "夕食の買い物"
    }
    ```

  - `entry_date`: Date or Timestamp - カレンダー表示やソートに使用する主要な日付/日時（テーマの `fields` から代表的なものを格納するか、別途定義）
  - `created_at`: Timestamp
  - `updated_at`: Timestamp

- **ユーザーテーブル (`users`)**
  - `user_id`: UUID (Primary Key) - ユーザーの一意な識別子
  - `email`: String (Unique) - ログインに使用するメールアドレス
  - `password_hash`: String - ハッシュ化されたパスワード
  - `created_at`: Timestamp
  - `updated_at`: Timestamp

## 3. 非機能要件

- **ユーザビリティ:**
  - 直感的で理解しやすいユーザーインターフェースを提供する。
  - テーマの追加やイベントの登録・編集操作が容易に行えること。
  - 視認性の高いカレンダーデザインとする。
- **パフォーマンス:**
  - カレンダー表示、イベント登録・編集、検索などの操作がスムーズに行えること。
  - データ量が増加しても、許容可能なレスポンスタイムを維持すること。
- **拡張性:**
  - 将来的な機能追加（通知、繰り返し設定、外部カレンダー連携など）を容易にする設計とする。
  - 新しいデータ型や入力 UI コンポーネントを追加しやすい構造とする。
- **データ永続性:**
  - 登録されたテーマ定義、イベント/データはアプリを終了しても保持されること。
  - （検討事項）データバックアップ、およびオプションとしてのクラウド同期機能。
- **プラットフォーム:**
  - （ターゲットプラットフォームを明記：例 iOS, Android, Web ブラウザ）
- **セキュリティ:**
  - （クラウド同期などを実装する場合）ユーザーデータの適切な保護、認証・認可メカニズムを実装する。

## 4. その他

- **将来的な拡張機能案:**
  - イベント/タスクのリマインダー通知機能
  - 繰り返しイベント/タスクの登録機能
  - Google カレンダーなど外部カレンダーとの連携機能
  - テーマやイベントの共有機能
  - データのエクスポート/インポート機能
  - 統計・レポート機能（例：家計簿の月次集計）
